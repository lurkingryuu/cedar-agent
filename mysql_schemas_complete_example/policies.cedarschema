permit (
  principal,
  action in
    [Action::"Select", Action::"Insert", Action::"Update", Action::"Delete"],
  resource
)
when
{
  principal has "user_role" &&
  principal["user_role"] == "employee" &&
  resource has "data_classification" &&
  resource["data_classification"] == "priv" &&
  ["mon", "tue", "wed", "thu", "fri"].contains(context["day"]) &&
  90000 <= context["time"] &&
  context["time"] <= 210000 &&
  context["ip"].isInRange(ip("127.0.0.0/8"))
};

permit (
  principal,
  action in [Action::"Select"],
  resource
)
when
{
  principal has "user_role" &&
  principal["user_role"] == "intern" &&
  resource has "data_classification" &&
  resource["data_classification"] == "public" &&
  ["mon", "tue", "wed", "thu", "fri"].contains(context["day"]) &&
  90000 <= context["time"] &&
  context["time"] <= 210000 &&
  context["ip"].isInRange(ip("198.0.0.0/8"))
};

permit (
  principal,
  action in [Action::"Select"],
  resource
)
when
{
  principal has "user_role" &&
  principal["user_role"] == "manager" &&
  resource has "data_classification" &&
  resource["data_classification"] == "sensitiv" &&
  ["mon", "tue", "wed", "thu", "fri"].contains(context["day"]) &&
  90000 <= context["time"] &&
  context["time"] <= 210000 &&
  context["ip"].isInRange(ip("127.0.0.0/8"))
};

permit (
  principal,
  action,
  resource
)
when
{
  resource is Column
}
